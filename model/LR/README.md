# LR Model
### 微软原文PDF：[《Predicting Clicks: Estimating the Click-Through Rate for New Ads》](Microsoft_LR_Paper.pdf)
## 模型提出背景和研究动机
在搜索引擎广告系统中，点击率的预测对于广告展示的排序至关重要。广告的展示位置与点击率有强相关性，越靠前的广告被点击的概率越高。
因此，准确预测广告的点击率，不仅能提升用户点击量，还能增加广告收益。

在最早期的时候，人们通过计算已经展示过的广告的历史数据（点击率，曝光率，展示率），通过计算平均值（ $\bar{\text{CTR}}$ ）等数据为广告进行排序。
然而
1. 这一方法无法处理新的广告，因为新的广告没有历史数据。
2. 此外，历史CTR估算方法对数据稀疏性非常敏感，对于展示次数较少的广告，CTR估算的方差较大，结果不稳定。
## 解决了什么问题？
因此回归模型自然而然地就被提出了，通过考虑多个变量对CTR的影响搭建线性模型，就可以实现对新数据的预测。
## 如何解决？
LR模型将`广告的特征`作为输入（包括广告的标题、正文内容、关键词、广告链接以及与广告相关的其他统计信息等）
通过逻辑回归算法，模型可以根据广告内容特征以及统计信息来预测新广告的点击率，从而能够对新广告进行合理排序。
## 效果如何？
该模型使得CTR预测模型可以使用算法模型预测，而不是基于规则或简单的数学规则.

- **Baseline Model**： 只使用某一广告历史CTR的平均值作为衡量标准
- **Term CTR**：普通的LR模型
- **Related Term CTR**：普通的LR模型基础上引入了相关性的概念，作者认为一个广告的点击率应该与和他相似的广告的CTR有关。（例如两个广告：买红色的鞋和卖红色的鞋）
因此，该模型认为广告的最终预测结果等于和他相关的所有广告用LR模型预测出的CTR的平均值。


$\text{CTR}(t) = \frac{1}{|R(t)|} \sum_{x \in R(t)} \text{CTR}(x)$


模型训练细节：
1. 对数据进行了标准化，并将五个 $\sigma$ 以外的离群点强制缩到 $5 \sigma$
2. 使用BCE作为损失函数
3. 使用MSE和KL散度作为Metrics

| Features                    | MSE (x 1e-3) | KL Divrg. (x 1e-2) | % Imprv.  |
|-----------------------------|--------------|--------------------|-----------|
| Baseline ( $\bar{\text{CTR}}$ ) | 4.79         | 4.03               | -         |
| Term CTR                    | 4.37         | 3.50               | 13.28%    |
| Related term CTRs           | 4.12         | 3.24               | 19.67%    |

结果可以看出， 普通的LR模型Term CTR 的KL散度提升了 13.28%，加了相关性的 Related term CTRs  提升了19.67%  





